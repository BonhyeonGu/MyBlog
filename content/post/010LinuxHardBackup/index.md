---
title: "리눅스 디스크 백업"
description: "백업의 종류, 여러가지 방법의 나열입니다."
date: 2022-03-25T11:21:02+09:00
categories: ["리눅스"]
tags: ["backup", "dd", "dump", "tar"]
image: "thum.png"
draft: false
---
## 백업

### 설명

백업/복원은 말 그대로 나중에 되돌릴 수 있게 사본을 복사하여 저장하는 기능입니다. 과거에도 OS에서 지원하는  
소프트웨어가 있었지만, 그럼에도 저 같은 경우에는 CD, USB에 담아서 사용하는 고스트를 자주 봤었던 기억이 있습니다.  

그 이유와 관련하여 방식의 종류를 살펴보도록 하겠습니다.

### 백업의 종류

디스크를 통째로, 디스크의 일부 파티션만, 파일만 백업, 이것을 떠나서 백업은 세 가지의 방식이 존재합니다.  
1일 2일 3일, 총 삼일 동안 파일이 써지고 있는 동일한 시스템을 백업했다고 가정하고 예를 들어보겠습니다.

전체 백업(Full)  
 1일 //// __ __  
 2일 //// //// __  
 3일 //// //// ////  

차등 백업(Differential)  
 1일 //// __ __  
 2일 __ //// __  
 3일 __ //// ////  

증분 백업(Incremental)  
 1일 //// __ __  
 2일 __ //// __  
 3일 __ __ ////  

간단히 전체는 그 말대로 모든 내용을, 차등은 첫 백업 이후의 내용들을, 증분백업은 각 백업시의 변화 내용을  
기록하는 것입니다. 이렇게 보면 증분백업이 가장 좋아보이지만 복원시 오랜 시간이 소모되고 백업 파일이  
하나라도 손실되면 복원이 불가능한 특징을 가지고 있습니다.

요즘엔 고스트가 윈도우에 설치되어 증분백업까지 지원을 하지만 과거의, 특히 컴퓨터 수리를 업으로 하는 입장에서는  
각기 다른 시스템을 접해야 했기 때문에 전체 백업이 좋은 선택지였다고 생각합니다.

참고로 맥의 타임머신도 기본은 증분백업이며, 타임머신을 포함한 대부분 요즘 소프트웨어는 세 가지 백업 방식을  
모두 지원하고 있습니다.

## 명령

### tar

tar은 백업보다 압축이 주 목적인 명령어입니다.

파일 전체백업

```bash
tar cvfp home.tar /file
```

파일 증분백업
```bash
tar cvfp home.tar /file
```

백업 위치지정
```bash
tar zcf /dev/sdb1 /file
``

현재 디렉토리에 압축 해제
```bash
tar zcf /dev/sdb1 /now
```

### dump

파일 전체백업
```bash
dump -0f /dev/sdb1 /file
```

파티션 백업(sda1), 경로지정, 정보 기록(-u:/etc/dumpdates로)
```bash
dump -0u -f /dev/sdb1 /dev/sda1
```

증분 백업(-2:2레벨의 백업)
```bash
dump -2u -f /dev/sdb1 /dev/sda1
```

복원(-r:전체:단 파일시스템 마운트 동일해야함, -i:대화식)
```bash
restore -rf /dev/sdb1
```

### dd

디스크 전체, 특정 파티션 모두 가능합니다. 해당 명령어는 백업뿐만 아니라 여러곳에서 쓰입니다.

전체 백업(bs:블럭 사이즈, 디스크 형편에 맞출 것)

```bash
dd if=/dev/sda of=/dev/sdb bs=256k
```
